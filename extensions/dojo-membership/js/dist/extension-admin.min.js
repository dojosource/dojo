jQuery(function(t){t(".dojo-membership-student-application .payment-received").click(function(){var n={student:dojo.param("student_id")};t.post(dojo.ajax("membership","record_payment_received"),n,function(){window.location.reload()})}),t(".dojo-membership-student-application .approve-membership").click(function(){var n={student:dojo.param("student_id")};t.post(dojo.ajax("membership","approve_application"),n,function(){window.location.reload()})})}),jQuery(function(t){t(".dojo-student-contract .dojo-change-contract").click(function(){t(".dojo-current-membership").hide(),t(".dojo-change-membership").show()}),t(".dojo-student-contract .dojo-change-membership select").change(function(){t(".dojo-apply-change-contract").show()}),t(".dojo-student-contract .dojo-apply-change-contract").click(function(){var n={student:dojo.param("student_id"),contract:t(".dojo-student-contract select[name=contract] option:selected").val()};t.post(dojo.ajax("membership","change_student_contract"),n,function(){window.location.reload()})})}),jQuery(function(t){t(".dojo-student-due .payment-received").click(function(){var n={student:dojo.param("student_id")};t.post(dojo.ajax("membership","record_payment_received"),n,function(){window.location.reload()})})}),jQuery(function(t){t(".dojo-contracts-edit #cancellation_policy").change(function(){"days"==t(this).val()?t(".cancellation-days-row").show():t(".cancellation-days-row").hide()})}),jQuery(function(t){function n(){t(".dojo-rank-list li").length>=2?t(".dojo-drag-notice").show():t(".dojo-drag-notice").hide()}function o(n,o){var i=t('<li><span class="dojo-rank">'+n+'</span> <span class="dojo-delete dashicons dashicons-dismiss dojo-right dojo-red" style="cursor:pointer;"></span><a href="javascript:;" class="dojo-right" style="margin-right:10px;">edit</a></li>');return i.attr("data-rank-id",o),i.find("a").click(function(t){e(t)}),i.find(".dojo-delete").click(function(t){a(t)}),i}function e(n){function e(){d=r.val(),i.replaceWith(o(d,c))}function a(){i.replaceWith(o(d,c))}var i=t(n.currentTarget).closest("li"),d=i.find(".dojo-rank").text(),c=i.attr("data-rank-id"),r=t('<input type="text" style="width:auto;">');r.attr("value",d),i.html(""),i.append('<button class="button dojo-right">Save</button> <a href="javascript:;" class="dojo-cancel-edit dojo-right dojo-red-link" style="margin-right:10px;">cancel</a>'),i.append(r),r.select(),r.keydown(function(t){13==t.keyCode&&(t.preventDefault(),e()),27==t.keyCode&&a()}),i.find("a").click(function(){a()}),i.find("button").click(function(){e()})}function a(n){function e(){c?t.post(dojo.ajax("membership","delete_rank"),{rank_id:c},function(t){"success"!=t?alert(t):i.remove()}):i.remove()}function a(){i.replaceWith(o(d,c))}var i=t(n.currentTarget).closest("li"),d=i.find(".dojo-rank").text(),c=i.attr("data-rank-id");i.html(""),i.append('<button class="button dojo-right">Delete</button> <a href="javascript:;" class="dojo-cancel-edit dojo-right dojo-red-link" style="margin-right:10px;">cancel</a>'),i.append("<strong>Delete this. Are you sure?</strong><br />"+d),i.find("a").click(function(){a()}),i.find("button").click(function(t){t.preventDefault(),e()})}t(".dojo-rank-types-edit form[name=post]").submit(function(){t(".dojo-rank-list .dojo-cancel-edit").click();var n=[];t(".dojo-rank-list li").each(function(){n.push({id:t(this).attr("data-rank-id"),title:t(this).find(".dojo-rank").text()});var o=t('<input type="hidden" name="ranks">');o.val(JSON.stringify(n)),t(this).append(o)})}),t(".dojo-rank-types-edit input[name=title]").change(function(){t(".dojo-ranks-label").text(t(this).val()+" Ranks")}),t(".dojo-rank-types-edit input[name=new_rank]").keydown(function(n){13==n.keyCode&&(n.preventDefault(),t(".dojo-add-rank").click())}),t(".dojo-rank-types-edit .dojo-add-rank").click(function(e){e.preventDefault();var a=t("input[name=new_rank]").val();""!=a&&(t(".dojo-rank-list").append(o(a)),n()),t("input[name=new_rank]").val("")}),t(".dojo-rank-types-edit .dojo-rank-list a").click(function(t){e(t)}),t(".dojo-rank-types-edit .dojo-rank-list .dojo-delete").click(function(t){a(t)}),n(),t(".dojo-rank-types-edit .dojo-rank-list").sortable()}),jQuery(function(t){var n=new Date;t(".dojo-students-edit input[name=dob]").datepicker({changeMonth:!0,changeYear:!0,yearRange:"1930:"+n.getFullYear()})});